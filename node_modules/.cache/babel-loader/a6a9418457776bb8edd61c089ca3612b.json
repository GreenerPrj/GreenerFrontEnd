{"ast":null,"code":"var _jsxFileName = \"/Users/bag-yeongmi/GreenerFrontEnd/src/Components/pages/board/MarketChange.js\",\n    _s = $RefreshSig$();\n\nimport { useParams } from \"react-router-dom\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport { Button } from \"@mui/material\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst MarketChange = () => {\n  _s();\n\n  const {\n    boardsId\n  } = useParams(); // 게시판 제목, 내용, 사진\n\n  const [title, setTitle] = useState(\"\");\n  const [content, setContent] = useState(\"\");\n  const [image, setImage] = useState({\n    image_file: \"\",\n    preview_URL: `/api/v1/boards/${boardsId}/detail/images`\n  });\n  let inputRef;\n\n  const saveImage = e => {\n    e.preventDefault();\n    const fileReader = new FileReader();\n\n    if (e.target.files[0]) {\n      fileReader.readAsDataURL(e.target.files[0]);\n    }\n\n    fileReader.onload = () => {\n      setImage({\n        image_file: e.target.files[0],\n        preview_URL: fileReader.result\n      });\n    };\n  };\n\n  useEffect(() => {\n    const getBoard = async () => {\n      axios.defaults.headers.common['accessToken'] = `Bearer ${localStorage.getItem(\"access\")}`;\n      const {\n        data\n      } = await axios.get(`/api/v1/boards/${boardsId}/detail`);\n      return data;\n    };\n\n    getBoard().then(result => {\n      console.log(result);\n      setTitle(result.title);\n      setContent(result.content); // 이미지는 파일을 불러올 필요가 없이 미리보기 url만 가져온다.\n      // 이미지를 선택하지 않고 올리면 db에 저장되어 있는 이미지를 그대로 사용!\n\n      setImage({ ...image,\n        preview_URL: `/api/v1/boards/${boardsId}/detail/images`\n      });\n      console.log(result.img);\n      console.log(image);\n    });\n  }, []);\n  const canSubmit = useCallback(() => {\n    return content !== \"\" && title !== \"\";\n  }, [image, title, content]);\n  const handleSubmit = useCallback(async () => {\n    try {\n      const formData = new FormData();\n      const data = {\n        title: title,\n        content: content\n      };\n      const json = JSON.stringify(data);\n      const blob = new Blob([json], {\n        type: \"application/json\"\n      });\n      formData.append(\"boardsUpdateRequest\", blob);\n      formData.append(\"files\", image.image_file);\n      console.log(...formData);\n      axios.defaults.headers.common['accessToken'] = `Bearer ${localStorage.getItem(\"access\")}`;\n      await axios.put(`/api/v1/boards/${boardsId}`, formData);\n      window.alert(\"수정이 완료되었습니다.\");\n      window.location.href = `/marketdetail/${boardsId}`;\n    } catch (e) {}\n  }, [canSubmit]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"addBoard-wrapper\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"addBoard-header\",\n      children: \"\\uAC8C\\uC2DC\\uBB3C \\uC218\\uC815\\uD558\\uAE30 \\uD83D\\uDD8A\\uFE0F\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"addBoard-body\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text\",\n        children: [\"\\uC81C \\uBAA9 \", /*#__PURE__*/_jsxDEV(\"input\", {\n          onChange: e => {\n            setTitle(e.target.value);\n          },\n          className: \"title\",\n          value: title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 13\n        }, this), \"\\uB0B4 \\uC6A9 \", /*#__PURE__*/_jsxDEV(\"input\", {\n          onChange: e => {\n            setContent(e.target.value);\n          },\n          className: \"content\",\n          value: content\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        accept: \"image/*\",\n        onChange: saveImage,\n        ref: refParam => inputRef = refParam,\n        style: {\n          display: \"none\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"img-wrapper\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: image.preview_URL\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"upload-button\",\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"outlined\",\n          color: \"primary\",\n          onClick: () => inputRef.click(),\n          children: \"\\uC774\\uBBF8\\uC9C0 \\uC120\\uD0DD\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"submitButton\",\n      children: canSubmit() ? /*#__PURE__*/_jsxDEV(Button, {\n        onClick: handleSubmit,\n        className: \"success-button\",\n        variant: \"outlined\",\n        children: \"\\uC218\\uC815\\uD558\\uAE30\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(Button, {\n        className: \"disable-button\",\n        variant: \"outlined\",\n        size: \"large\",\n        children: \"\\uC81C\\uBAA9\\uACFC \\uB0B4\\uC6A9\\uC744 \\uBAA8\\uB450 \\uC785\\uB825\\uD558\\uC138\\uC694\\uD83D\\uDE2D\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 5\n  }, this);\n};\n\n_s(MarketChange, \"vXfO6FfAH5gskcTnrRvX+k4dfms=\", false, function () {\n  return [useParams];\n});\n\n_c = MarketChange;\nexport default MarketChange;\n\nvar _c;\n\n$RefreshReg$(_c, \"MarketChange\");","map":{"version":3,"names":["useParams","useCallback","useEffect","useState","Button","axios","MarketChange","boardsId","title","setTitle","content","setContent","image","setImage","image_file","preview_URL","inputRef","saveImage","e","preventDefault","fileReader","FileReader","target","files","readAsDataURL","onload","result","getBoard","defaults","headers","common","localStorage","getItem","data","get","then","console","log","img","canSubmit","handleSubmit","formData","FormData","json","JSON","stringify","blob","Blob","type","append","put","window","alert","location","href","value","refParam","display","click"],"sources":["/Users/bag-yeongmi/GreenerFrontEnd/src/Components/pages/board/MarketChange.js"],"sourcesContent":["import {useParams} from \"react-router-dom\";\nimport {useCallback, useEffect, useState} from \"react\";\nimport {Button} from \"@mui/material\";\nimport axios from \"axios\";\n\n\nconst MarketChange = () => {\n  const {boardsId} = useParams();\n  // 게시판 제목, 내용, 사진\n  const [title, setTitle] = useState(\"\");\n  const [content, setContent] = useState(\"\");\n  const [image, setImage] = useState({\n    image_file: \"\",\n    preview_URL: `/api/v1/boards/${boardsId}/detail/images`});\n\n    let inputRef;\n\n    const saveImage = (e) => {\n      e.preventDefault();\n      const fileReader = new FileReader();\n      if (e.target.files[0]) {\n        fileReader.readAsDataURL(e.target.files[0]);\n      }\n      fileReader.onload = () => {\n        setImage({\n          image_file: e.target.files[0],\n          preview_URL: fileReader.result,\n        })\n      };\n    };\n\n  useEffect(() => {\n    const getBoard = async () => {\n      axios.defaults.headers.common['accessToken'] = `Bearer ${localStorage.getItem(\"access\")}`;\n      const {data} = await axios.get(`/api/v1/boards/${boardsId}/detail`);\n      return data;\n    }\n    getBoard().then((result) => {\n      console.log(result)\n      setTitle(result.title);\n      setContent(result.content);\n      // 이미지는 파일을 불러올 필요가 없이 미리보기 url만 가져온다.\n      // 이미지를 선택하지 않고 올리면 db에 저장되어 있는 이미지를 그대로 사용!\n      setImage({...image, preview_URL: `/api/v1/boards/${boardsId}/detail/images`})\n      console.log(result.img)\n      console.log(image)\n    });\n  }, [])\n\n\n  const canSubmit = useCallback(() => {\n    return content !== \"\" && title !== \"\";\n  }, [image, title, content]);\n\n  const handleSubmit = useCallback(async () => {\n    try {\n\n      const formData = new FormData();\n      \n      const data = {\n        title: title,\n        content: content\n      }\n      const json = JSON.stringify(data)\n      const blob = new Blob([json], { type: \"application/json\" });\n      formData.append(\"boardsUpdateRequest\", blob);\n\n      formData.append(\"files\", image.image_file);\n\n      console.log(...formData)\n\n      axios.defaults.headers.common['accessToken'] = `Bearer ${localStorage.getItem(\"access\")}`;\n      await axios.put(`/api/v1/boards/${boardsId}`, formData);\n      window.alert(\"수정이 완료되었습니다.\");\n\n      window.location.href = `/marketdetail/${boardsId}`;\n    } catch (e) {\n\n\n    }\n\n  }, [canSubmit]);\n\n  return (\n    <div className=\"addBoard-wrapper\">\n      <div className=\"addBoard-header\">\n        게시물 수정하기 🖊️\n      </div><br/>\n\n      <div className=\"addBoard-body\">\n        <div className=\"text\">\n          제 목 <input\n            onChange={(e) => {setTitle(e.target.value);}}\n            className=\"title\"\n            value={title}\n          /><br/>\n          내 용 <input\n            onChange={(e) => {setContent(e.target.value);}}\n            className=\"content\"\n            value={content}\n          />\n        </div>\n\n          <input\n          type=\"file\"\n          accept=\"image/*\"\n          onChange={saveImage}\n          ref={(refParam) => (inputRef = refParam)}\n          style={{ display: \"none\" }}\n        />\n        <div className=\"img-wrapper\">\n          <img src={image.preview_URL} />\n        </div>\n        <div className=\"upload-button\">\n          <Button\n            variant=\"outlined\"\n            color=\"primary\"\n            onClick={() => inputRef.click()}\n          >\n            이미지 선택\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"submitButton\">\n        {canSubmit() ? (\n          <Button\n            onClick={handleSubmit}\n            className=\"success-button\"\n            variant=\"outlined\"\n          >\n            수정하기\n          </Button>\n        ) : (\n          <Button\n            className=\"disable-button\"\n            variant=\"outlined\"\n            size=\"large\"\n          >\n            제목과 내용을 모두 입력하세요😭\n          </Button>\n        )}\n      </div>\n    </div>\n\n\n    \n  );\n}\n\nexport default MarketChange"],"mappings":"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"},"metadata":{},"sourceType":"module"}